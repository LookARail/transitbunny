<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>GTFS Animation</title>  
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />  
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div id="map"></div>

<div id="controls" >
  <div class="main-menu-title">GTFS Data Sorce:</div>
  <span id="dataSourceText" style="font-size:0.98em; color:#0078d7; margin-bottom:0px; display:block;">
    Default - Vancouver GTFS Data 2025-08-08
  </span>
  <div class="main-menu-upload">
    <button id="uploadGtfsBtn"><span style="font-size:1.2em;">üìÅ</span> Upload My Own GTFS ZIP</button>
    <input type="file" id="gtfsFileInput" accept=".zip" style="display:none" />
    <div id="progressBarContainer" style="display:none;">
      <div id="progressBar"></div>
    </div>
  </div>
  
  <div class="main-menu-title">Trip Filters</div>
  <div class="main-menu-filters">
    <!-- Route Type Filter -->
    <label>
      <span class="tooltip">
        Route Type:
        <span class="tooltiptext">
          Route Type Typically has the following nomenclature:<br>1 = Subway/Metro<br>2 = Rail<br>3 = Bus<br>4 = Ferry<br>MultiSelect is available
        </span>
      </span>
      <select id="routeTypeSelect" multiple size="4" style="min-width: 120px;"></select>
    </label>
    <!-- Route Name Filter -->
    <label>
      <span class="tooltip">
        Route Name:
        <span class="tooltiptext">
          Route Name is the name of the route, such as "Red Line" or "180".<br>MultiSelect is available
        </span>
      </span>
      <select id="routeShortNameSelect" multiple size="4" style="min-width: 120px; max-width: 300px;"></select>
    </label>
    <!-- Service Pattern ID Filter -->
    <label>
      <span class="tooltip">
        Service Pattern ID:    
        <span class="tooltiptext">
          Service Pattern ID is a unique identifier for the service pattern defined in the Calendar or Calendar_date file.<br>MultiSelect is available
        </span>
      </span>
      <select id="serviceIdSelect" multiple size="4" style="min-width: 120px;"></select>
    </label>
    <button id="updateMapBtn" style="margin-top:12px;">Update Map</button>
  </div>
</div>

<!-- Animation Controls Canvas -->
<div id="animationCanvas" class="floating-canvas" style="display:none;">
  <div class="canvas-header">Animation Controls</div>
  <div class="canvas-content">
    <div class="row-controls">
      <label for="speedSelect">Speed:</label>
      <select id="speedSelect">
        <option value="1">1x</option>
        <option value="10" selected>10x</option>
        <option value="60">60x</option>
        <option value="300">300x</option>
      </select>
      <span id="timeDisplay">00:00:00</span>
    </div>
    <div class="row-buttons">
      <button id="playBtn">‚ñ∂Ô∏è Play</button>
      <button id="pauseButton"> ‚èØÔ∏è Pause</button>
      <button id="stopBtn">‚èπÔ∏è Stop</button>
    </div>
  </div>
</div>


  <!-- Graphs Canvas with Tabs -->
<div id="graphsCanvas" class="floating-canvas" style="display:none;">
  <div class="canvas-header">
    <button class="tab-btn active" data-tab="tripPlotTab"># of Trips</button>
    <button class="tab-btn" data-tab="vehKmPlotTab">Vehicle-Kilometer</button>
  </div>
  <div class="canvas-content">
    <div id="tripPlotTab" class="tab-content active">
      <canvas id="tripPlot"></canvas>
    </div>
    <div id="vehKmPlotTab" class="tab-content">
      <canvas id="vehKmPlot"></canvas>
    </div>
  </div>
</div>

<!-- Statistics Canvas with Tabs -->
<div id="statsCanvas" class="floating-canvas" style="display:none;">
  <div class="canvas-header">
    <button class="tab-btn active" data-tab="routeStatsTab">Route Statistics</button>
    <!-- Future stats tabs go here -->
  </div>
  <div class="canvas-content">
    <div id="routeStatsTab" class="tab-content active">
      <button id="GenerateStat">Generate Statistics</button>
      <button id="DownloadStat">Download CSV</button>
      <div id="routeStatsTableWrapper">
        <div id="routeStatsTable"></div>
      </div>
    </div>
  </div>
</div>

<!-- Ribbon/Taskbar at bottom -->
<div id="ribbonPanel">
  <button class="ribbon-icon" data-canvas="animationCanvas" title="Animation Controls">‚ñ∂Ô∏è</button>
  <button class="ribbon-icon" data-canvas="graphsCanvas" title="Graphs">üìà</button>
  <button class="ribbon-icon" data-canvas="statsCanvas" title="Statistics">üìä</button>
  <button class="ribbon-icon" data-canvas="" title="Future Feature">‚≠ê</button>
</div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- Your main GTFS JS -->
  <script src= "https://cdn.jsdelivr.net/npm/fflate/umd/index.js"></script>
  <script src="main.js"></script>
  <script src="analysis.js"></script>
</body>
</html>
